---
title: "Primed Memory Retrieval Analysis"
author: "Abhilasha Kumar"
date: "November 16, 2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Reading and Formatting Data

```{r }
memory500 = read.csv("Compiled_Final500ms_CSV.csv", header = TRUE, sep = ",")
memory32 = read.csv("Compiled_Final32ms_CSV.csv", header = TRUE, sep = ",")
memory125 = read.csv("Compiled_Final125ms_CSV.csv", header = TRUE, sep = ",")
memory48 = read.csv("Compiled_Final48ms_CSV.csv", header = TRUE, sep = ",")
```

# Means Per Prime Condition

##32 ms

```{r }
library(dplyr)
prime_acc_32 = group_by(memory32, PrimeCondition) %>%
  summarise_at(vars(ImmediateAccuracy, DelayedAccuracy,RTImmediate, RTDelayed), mean)

prime_subject_acc_32 = group_by(memory32, Subject, PrimeCondition) %>%
  summarise_at(vars(ImmediateAccuracy, DelayedAccuracy,RTImmediate, RTDelayed), mean)
```

##48 ms

```{r}
library(dplyr)
prime_acc_48 = group_by(memory48, PrimeCondition) %>%
  summarise_at(vars(ImmediateAccuracy, DelayedAccuracy,RTImmediate, RTDelayed), mean)

prime_subject_acc_48 = group_by(memory48, Subject, PrimeCondition) %>%
  summarise_at(vars(ImmediateAccuracy, DelayedAccuracy,RTImmediate, RTDelayed), mean)
```

##500 ms
```{r}
library(dplyr)
prime_acc_500 = group_by(memory500, PrimeCondition) %>%
  summarise_at(vars(ImmediateAccuracy, DelayedAccuracy,RTImmediate, RTDelayed), mean)

prime_subject_acc_500 = group_by(memory500, Subject, PrimeCondition) %>%
  summarise_at(vars(ImmediateAccuracy, DelayedAccuracy,RTImmediate, RTDelayed), mean)
```


#ANOVAS

## 32 ms

### ANOVA for Immediate Recall

```{r}
prime_subject_acc_32$PrimeCondition = as.factor(prime_subject_acc_32$PrimeCondition)
prime_subject_acc_32$Subject = as.factor(prime_subject_acc_32$Subject)

immediate_aov_32 = aov(data = prime_subject_acc_32, 
                        ImmediateAccuracy ~ PrimeCondition +
                                 Error(Subject/PrimeCondition))
summary(immediate_aov_32)

options(contrasts = c('contr.sum', 'contr.poly'))
library(lsmeans)
library(multcomp)
imm_lsm = lsmeans::lsmeans(immediate_aov_32, c("PrimeCondition"))
prime_effect = cld(imm_lsm, alpha = 0.05, 
                adjust = "tukey", details = TRUE)
library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
```

### ANOVA for Delayed Recall
```{r}
delayed_aov_32 = aov(data = prime_subject_acc_32, 
                      DelayedAccuracy ~ PrimeCondition +
                                 Error(Subject/PrimeCondition))
summary(delayed_aov_32)
```

##48 ms

###ANOVA for Immediate Recall
```{r}
prime_subject_acc_48$PrimeCondition = as.factor(prime_subject_acc_48$PrimeCondition)
prime_subject_acc_48$Subject = as.factor(prime_subject_acc_48$Subject)

immediate_aov_48 = aov(data = prime_subject_acc_48, 
                        ImmediateAccuracy ~ PrimeCondition +
                                 Error(Subject/PrimeCondition))
summary(immediate_aov_48)

options(contrasts = c('contr.sum', 'contr.poly'))
library(lsmeans)
library(multcomp)
imm_lsm = lsmeans::lsmeans(immediate_aov_48, c("PrimeCondition"))
prime_effect = cld(imm_lsm, alpha = 0.05, 
                adjust = "tukey", details = TRUE)
library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
```


###ANOVA for Delayed Recall
```{r}
delayed_aov_48 = aov(data = prime_subject_acc_48, 
                      DelayedAccuracy ~ PrimeCondition +
                                 Error(Subject/PrimeCondition))
summary(delayed_aov_48)
```

##500 ms

###ANOVA for Immediate Recall
```{r}
prime_subject_acc_500$PrimeCondition = as.factor(prime_subject_acc_500$PrimeCondition)
prime_subject_acc_500$Subject = as.factor(prime_subject_acc_500$Subject)
immediate_aov_500 = aov(data = prime_subject_acc_500, 
                        ImmediateAccuracy ~ PrimeCondition +
                                 Error(Subject/PrimeCondition))
summary(immediate_aov_500)

options(contrasts = c('contr.sum', 'contr.poly'))
library(lsmeans)
library(multcomp)
imm_lsm = lsmeans::lsmeans(immediate_aov_500, c("PrimeCondition"))
prime_effect = cld(imm_lsm, alpha = 0.05, 
                adjust = "tukey", details = TRUE)
library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
```

###ANOVA for Delayed Recall
```{r}
delayed_aov_500 = aov(data = prime_subject_acc_500, 
                      DelayedAccuracy ~ PrimeCondition +
                                 Error(Subject/PrimeCondition))
summary(delayed_aov_500)
```

#Conditional Accuracy

##32 ms

##Organizing Data

```{r}
library(dplyr)
## overall delayed acc means split by imm acc (0/1)
cond_32 = group_by(memory32, ImmediateAccuracy, PrimeCondition) %>%
  summarise_at(vars(DelayedAccuracy), mean)
##per subject
cond_sub_32 = group_by(memory32, Subject, ImmediateAccuracy, PrimeCondition) %>%
  summarise_at(vars(DelayedAccuracy), mean)
##taking only correct immediate responses from this:
cond_sub_correct_32 = subset(cond_sub_32, cond_sub_32$ImmediateAccuracy == "1")

#for 32 ms, S13 missing 1 rows for Semantic

cond_sub_correct_32[115,] = c("13",1,"Semantic", 0 )

## Merging immediate and delayed into one file:

## now we have conditional delayed accuracies in cond_sub_correct_32
## and we have immediate accuracies in prime_subject_acc_32
## now we must combine the two files. 

colnames(cond_sub_correct_32) = c("Subject", "IA", "PrimeCondition", "Delayed")
colnames(prime_subject_acc_32) = c("Subject", "PrimeCondition", "Immediate", "DA",
                                   "RTImm", "RTdel")

final_combined_32 = merge(cond_sub_correct_32, prime_subject_acc_32, 
                       by = c("Subject", "PrimeCondition"))

# now we have immediate and delayed accuracy in wide format, i.e. side to side.
# We need to convert to long format

#first we remove uneccesary columns, i.e. IA and DA

final_combined_32 = final_combined_32[, -c(3,6,7,8)]

# converting to long

library(tidyr)
final_long_32 <- final_combined_32 %>%
  gather(Delay, Accuracy, Immediate, Delayed)
  

final_long_32 <- final_long_32[order(final_long_32$Subject),]
final_long_32$Delay = as.factor(as.character(final_long_32$Delay))
final_long_32$Subject = as.factor(as.character(final_long_32$Subject))
final_long_32$Accuracy = as.numeric(as.character(final_long_32$Accuracy))
```

###Conditional ANOVA

```{r}
final_aov_32 = aov(data = final_long_32, Accuracy ~ Delay*PrimeCondition + 
                  Error(Subject/(Delay*PrimeCondition)))
summary(final_aov_32)

library(multcomp)
library(knitr)
options(contrasts = c('contr.sum', 'contr.poly'))

conditional_lsm = lsmeans::lsmeans(final_aov_32, c("Delay", "PrimeCondition"))
prime_effect = cld(conditional_lsm, alpha = 0.05, 
                adjust = "tukey", details = TRUE, by = "Delay")
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
```

##48 ms

###Organizing Data

```{r}
library(dplyr)
## overall delayed acc means split by imm acc (0/1)
cond_48 = group_by(memory48, ImmediateAccuracy, PrimeCondition) %>%
  summarise_at(vars(DelayedAccuracy), mean)
##per subject
cond_sub_48 = group_by(memory48, Subject, ImmediateAccuracy, PrimeCondition) %>%
  summarise_at(vars(DelayedAccuracy), mean)
##taking only correct immediate responses from this:
cond_sub_correct_48 = subset(cond_sub_48, cond_sub_48$ImmediateAccuracy == "1")

#for 48 ms, S12 has 2 rows missing

cond_sub_correct_48[89,] = c("12",1,"Semantic", 0 )
cond_sub_correct_48[90,] = c("12",1,"UnSemantic", 0 )

##  Merging immediate and delayed into one file:

## now we have conditional delayed accuracies in cond_sub_correct_48
## and we have immediate accuracies in prime_subject_acc_48
## now we must combine the two files. 

colnames(cond_sub_correct_48) = c("Subject", "IA", "PrimeCondition", "Delayed")
colnames(prime_subject_acc_48) = c("Subject", "PrimeCondition", "Immediate", "DA",
                                   "RTImm", "RTDel")

final_combined_48 = merge(cond_sub_correct_48, prime_subject_acc_48, 
                       by = c("Subject", "PrimeCondition"))

# now we have immediate and delayed accuracy in wide format, i.e. side to side.
# We need to convert to long format

#first we remove uneccesary columns, i.e. IA and DA

final_combined_48 = final_combined_48[, -c(3,6,7,8)]

# converting to long

library(tidyr)
final_long_48 <- final_combined_48 %>%
  gather(Delay, Accuracy, Immediate, Delayed)
  

final_long_48 <- final_long_48[order(final_long_48$Subject),]
final_long_48$Delay = as.factor(as.character(final_long_48$Delay))
final_long_48$Subject = as.factor(as.character(final_long_48$Subject))
final_long_48$Accuracy = as.numeric(as.character(final_long_48$Accuracy))
```

###Conditional ANOVA
```{r}
final_aov_48 = aov(data = final_long_48, Accuracy ~ Delay*PrimeCondition + 
                  Error(Subject/(Delay*PrimeCondition)))
summary(final_aov_48)

library(multcomp)
library(knitr)
options(contrasts = c('contr.sum', 'contr.poly'))

conditional_lsm = lsmeans::lsmeans(final_aov_48, c("Delay", "PrimeCondition"))
prime_effect = cld(conditional_lsm, alpha = 0.05, 
                adjust = "tukey", details = TRUE, by = "PrimeCondition")
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
```

##500 ms

###Organizing Data
```{r}
library(dplyr)
## overall delayed acc means split by imm acc (0/1)
cond_500 = group_by(memory500, ImmediateAccuracy, PrimeCondition) %>%
  summarise_at(vars(DelayedAccuracy), mean)
##per subject
cond_sub_500 = group_by(memory500, Subject, ImmediateAccuracy, PrimeCondition) %>%
  summarise_at(vars(DelayedAccuracy), mean)
##taking only correct immediate responses from this:
cond_sub_correct_500 = subset(cond_sub_500, cond_sub_500$ImmediateAccuracy == "1")

#for 500 ms, S36 and S42 have one row each missing

cond_sub_correct_500[99,] = c("36",1,"Neutral", 0 )
cond_sub_correct_500[100,] = c("42",1,"Phonological", 0 )

##  Merging immediate and delayed into one file:

## now we have conditional delayed accuracies in cond_sub_correct_500
## and we have immediate accuracies in prime_subject_acc_500
## now we must combine the two files. 

colnames(cond_sub_correct_500) = c("Subject", "IA", "PrimeCondition", "Delayed")
colnames(prime_subject_acc_500) = c("Subject", "PrimeCondition", "Immediate", 
                                    "DA", "RTImm", "RTDel")

final_combined_500 = merge(cond_sub_correct_500, prime_subject_acc_500, 
                       by = c("Subject", "PrimeCondition"))

# now we have immediate and delayed accuracy in wide format, i.e. side to side.
# We need to convert to long format

#first we remove uneccesary columns, i.e. IA and DA

final_combined_500 = final_combined_500[, -c(3,6,7,8)]

# converting to long

library(tidyr)
final_long_500 <- final_combined_500 %>%
  gather(Delay, Accuracy, Immediate, Delayed)
  

final_long_500 <- final_long_500[order(final_long_500$Subject),]
final_long_500$Delay = as.factor(as.character(final_long_500$Delay))
final_long_500$Subject = as.factor(as.character(final_long_500$Subject))
final_long_500$Accuracy = as.numeric(as.character(final_long_500$Accuracy))
```

###Conditional ANOVA
```{r}
final_aov_500 = aov(data = final_long_500, Accuracy ~ Delay*PrimeCondition + 
                  Error(Subject/(Delay*PrimeCondition)))
summary(final_aov_500)

library(multcomp)
library(knitr)
options(contrasts = c('contr.sum', 'contr.poly'))

conditional_lsm = lsmeans::lsmeans(final_aov_500, c("Delay", "PrimeCondition"))
prime_effect = cld(conditional_lsm, alpha = 0.05, 
                adjust = "tukey", details = TRUE, by = "PrimeCondition")
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
```


#Figures

##32 ms
###Immediate Recall

```{r, fig}

library(Rmisc)
immediateagg_rmisc_32 = summarySE(prime_subject_acc_32, 
                      measurevar = "Immediate",
                      groupvars = c("PrimeCondition"))

## IMMEDIATE
library(ggplot2)
library(ggthemes)
immediateagg_rmisc_32 %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                 levels = unique(PrimeCondition),
                    labels = c("Identical", "Neutral", 
                               "Phonological", "Semantic", "Unrelated")))%>%
ggplot(aes(x = PrimeCondition, y = Immediate))+
 geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
  geom_errorbar(aes(ymin = Immediate - ci, ymax = Immediate + ci),
                width=.05, position=position_dodge(.5)) +
  theme_few()+
  xlab("Prime Condition") + ylab("Mean Accuracy") + 
  ggtitle("Immediate: Mean Accuracy by Prime Condition")
```

### Delayed Recall
```{r}
library(Rmisc)
delayedagg_rmisc_32 = summarySE(prime_subject_acc_32,
                      measurevar = "DA",
                      groupvars = c("PrimeCondition"))
#DELAYED
delayedagg_rmisc_32 %>% mutate(PrimeCondition = factor(PrimeCondition,
                                                 levels = unique(PrimeCondition),
                    labels = c("Identical", "Neutral",
                               "Phonological", "Semantic", "Unrelated")))%>%
ggplot(aes(x = PrimeCondition, y = DA))+
 geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
  geom_errorbar(aes(ymin = DA - ci, ymax = DA + ci),
                width=.05, position=position_dodge(.5)) +
  theme_few()+
  xlab("Prime Condition") + ylab("Mean Accuracy") +
  ggtitle("Delayed: Mean Accuracy by Prime Condition")
```
### Conditional Recall
```{r}
## PLOTTING INTERACTION
agg_final_combined_32 = group_by(final_long_32, Delay, PrimeCondition)%>%
  summarise_at(vars(Accuracy), mean)
library(Rmisc)
agg_rmisc_32 = summarySE(final_long_32,
                      measurevar = "Accuracy",
                      groupvars = c("Delay", "PrimeCondition"))

agg_rmisc_32 %>% mutate(PrimeCondition = factor(PrimeCondition,
                                                 levels = unique(PrimeCondition),
                    labels = c("Identical", "Neutral",
                               "Phonological", "Semantic", "Unrelated")))%>%
  ggplot(aes(x = PrimeCondition, y = Accuracy, fill = Delay))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
                width=.05, position=position_dodge(.5)) +
  theme_few()+
  scale_fill_solarized()+
  xlab("Prime Condition") + ylab("Mean Accuracy") +
  ggtitle("Mean Accuracy by Prime Condition and Delay")
```

## 48ms
### Immediate Recall
```{r}
library(Rmisc)
immediateagg_rmisc_48 = summarySE(prime_subject_acc_48,
                      measurevar = "Immediate",
                      groupvars = c("PrimeCondition"))

## IMMEDIATE
library(ggplot2)
library(ggthemes)
ggplot(immediateagg_rmisc_48, aes(x = PrimeCondition, y = Immediate))+
 geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
  geom_errorbar(aes(ymin = Immediate - ci, ymax = Immediate + ci),
                width=.05, position=position_dodge(.5)) +
  theme_few()+
  xlab("Prime Condition") + ylab("Mean Accuracy") +
  ggtitle("Immediate: Mean Accuracy by Prime Condition")

```

### Delayed Recall
```{r}
library(Rmisc)
delayedagg_rmisc_48 = summarySE(prime_subject_acc_48,
                      measurevar = "DA",
                      groupvars = c("PrimeCondition"))
#DELAYED
ggplot(delayedagg_rmisc_48, aes(x = PrimeCondition, y = DA))+
 geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
  geom_errorbar(aes(ymin = DA - ci, ymax = DA + ci),
                width=.05, position=position_dodge(.5)) +
  theme_few()+
  xlab("Prime Condition") + ylab("Mean Accuracy") +
  ggtitle("Delayed: Mean Accuracy by Prime Condition")
```

### Conditional Recall
```{r}
## PLOTTING INTERACTION
agg_final_combined_48 = group_by(final_long_48, Delay, PrimeCondition)%>%
  summarise_at(vars(Accuracy), mean)
library(Rmisc)
agg_rmisc_48 = summarySE(final_long_48,
                      measurevar = "Accuracy",
                      groupvars = c("Delay", "PrimeCondition"))

agg_rmisc_48 %>% mutate(PrimeCondition = factor(PrimeCondition,
                                                 levels = unique(PrimeCondition),
                    labels = c("Identical", "Neutral",
                               "Phonological", "Semantic", "Unrelated")))%>%
  ggplot(aes(x = PrimeCondition, y = Accuracy, fill = Delay))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
                width=.05, position=position_dodge(.5)) +
  theme_few()+
  scale_fill_solarized()+
  xlab("Prime Condition") + ylab("Mean Accuracy") +
  ggtitle("Mean Accuracy by Prime Condition and Delay")
```

## 500 ms

### Immediate Recall
```{r}
library(Rmisc)
immediateagg_rmisc_500 = summarySE(prime_subject_acc_500, 
                      measurevar = "Immediate",
                      groupvars = c("PrimeCondition"))

## IMMEDIATE
library(ggplot2)
library(ggthemes)
ggplot(immediateagg_rmisc_500, aes(x = PrimeCondition, y = Immediate))+
 geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
  geom_errorbar(aes(ymin = Immediate - ci, ymax = Immediate + ci),
                width=.05, position=position_dodge(.5)) +
  theme_few()+
  xlab("Prime Condition") + ylab("Mean Accuracy") + 
  ggtitle("Immediate: Mean Accuracy by Prime Condition")

```

### Delayed Recall 
```{r}
library(Rmisc)
delayedagg_rmisc_500 = summarySE(prime_subject_acc_500, 
                      measurevar = "DA",
                      groupvars = c("PrimeCondition"))
#DELAYED
ggplot(delayedagg_rmisc_500, aes(x = PrimeCondition, y = DA))+
 geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
  geom_errorbar(aes(ymin = DA - ci, ymax = DA + ci),
                width=.05, position=position_dodge(.5)) +
  theme_few()+
  xlab("Prime Condition") + ylab("Mean Accuracy") + 
  ggtitle("Delayed: Mean Accuracy by Prime Condition")

```
### Conditional Recall
```{r}
## PLOTTING INTERACTION
agg_final_combined_500 = group_by(final_long_500, Delay, PrimeCondition)%>%
  summarise_at(vars(Accuracy), mean)
library(Rmisc)
agg_rmisc_500 = summarySE(final_long_500, 
                      measurevar = "Accuracy",
                      groupvars = c("Delay", "PrimeCondition"))

agg_rmisc_500 %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                 levels = unique(PrimeCondition),
                    labels = c("Identical", "Neutral", 
                               "Phonological", "Semantic", "Unrelated")))%>%
  ggplot(aes(x = PrimeCondition, y = Accuracy, fill = Delay))+
 geom_bar(stat = "identity", position = "dodge", width = 0.5)+
  geom_errorbar(aes(ymin = Accuracy - ci, ymax = Accuracy + ci),
                width=.05, position=position_dodge(.5)) +
  theme_few()+
  scale_fill_solarized()+
  xlab("Prime Condition") + ylab("Mean Accuracy") + 
  ggtitle("Mean Accuracy by Prime Condition and Delay")

```

#Reaction Time Analysis

## 32 ms
### First Trim for Error Trials and At 250 ms and 6000 ms

```{r}
memory32_trim = memory32 %>% filter(ImmediateAccuracy == '1') 
## removes 48 % trials

## now removing  <250 and >6000 trials

memory32_imm = memory32_trim %>% filter(RTImmediate >= 250 & RTImmediate <=6000)
## removes 2% trials
memory32_del = memory32_trim %>% filter(RTDelayed >=250 & RTImmediate <= 6000) 
## removes 2.5% trials
```


### Making the z-scores

For immediate RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_32 = group_by(memory32_imm, Subject) %>%
   summarise_at(vars(RTImmediate), mean)
 colnames(memory_mean_32) = c("Subject", "meanRTimm")
 
 memory_sd_32 = group_by(memory32_imm, Subject) %>%
   summarise_at(vars(RTImmediate), sd)
 colnames(memory_sd_32) = c("Subject", "sdRTimm")
 
 memory_agg_32 = merge(memory_mean_32, memory_sd_32, by = "Subject")
 
 ## merge aggregate info with long data
 memory32_imm = merge(memory32_imm, memory_agg_32, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory32_imm = memory32_imm %>% mutate(zRT_imm = 
                                          (RTImmediate - meanRTimm)/sdRTimm)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory32_imm, Subject) %>%
   summarise_at(vars(zRT_imm), mean)

```


For delayed RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_32 = group_by(memory32_del, Subject) %>%
   summarise_at(vars(RTDelayed), mean)
 colnames(memory_mean_32) = c("Subject", "meanRTdel")
 
 memory_sd_32 = group_by(memory32_del, Subject) %>%
   summarise_at(vars(RTDelayed), sd)
 colnames(memory_sd_32) = c("Subject", "sdRTdel")
 
 memory_agg_32 = merge(memory_mean_32, memory_sd_32, by = "Subject")
 
 ## merge aggregate info with long data
 memory32_del = merge(memory32_del, memory_agg_32, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory32_del = memory32_del %>% mutate(zRT_del = 
                                          (RTDelayed - meanRTdel)/sdRTdel)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory32_del, Subject) %>%
   summarise_at(vars(zRT_del), mean)
```

### Trimming and repeat z-scoring

```{r}
memory32_imm_trim = memory32_imm %>% filter(zRT_imm >= -3 & zRT_imm <= 3)
## removes 1.6% trials
memory32_del_trim = memory32_del %>% filter(zRT_del >= -3 & zRT_del <= 3)
## removes 2.9 % trials 
```

For immediate RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_32 = group_by(memory32_imm_trim, Subject) %>%
   summarise_at(vars(RTImmediate), mean)
 colnames(memory_mean_32) = c("Subject", "meanRTimm_final")
 
 memory_sd_32 = group_by(memory32_imm_trim, Subject) %>%
   summarise_at(vars(RTImmediate), sd)
 colnames(memory_sd_32) = c("Subject", "sdRTimm_final")
 
 memory_agg_32 = merge(memory_mean_32, memory_sd_32, by = "Subject")
 
 ## merge aggregate info with long data
 memory32_imm_trim = merge(memory32_imm_trim, 
                           memory_agg_32, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory32_imm_trim = memory32_imm_trim %>% mutate(zRT_imm_final = 
                          (RTImmediate - meanRTimm_final)/sdRTimm_final)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory32_imm_trim, Subject) %>%
   summarise_at(vars(zRT_imm_final), mean)

```

For delayed RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_32 = group_by(memory32_del_trim, Subject) %>%
   summarise_at(vars(RTDelayed), mean)
 colnames(memory_mean_32) = c("Subject", "meanRTdel_final")
 
 memory_sd_32 = group_by(memory32_del_trim, Subject) %>%
   summarise_at(vars(RTDelayed), sd)
 colnames(memory_sd_32) = c("Subject", "sdRTdel_final")
 
 memory_agg_32 = merge(memory_mean_32, memory_sd_32, by = "Subject")
 
 ## merge aggregate info with long data
 memory32_del_trim = merge(memory32_del_trim, 
                           memory_agg_32, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory32_del_trim = memory32_del_trim %>% mutate(zRT_del_final = 
                             (RTDelayed - meanRTdel_final)/sdRTdel_final)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory32_del_trim, Subject) %>%
   summarise_at(vars(zRT_del_final), mean)
```

 
### Immediate and Delayed ANOVAs
```{r}
 z_RT_32_imm = group_by(memory32_imm_trim, Subject, PrimeCondition) %>%
 summarise_at(vars(zRT_imm_final, RTImmediate), mean)

 z_RT_32_del = group_by(memory32_del_trim, Subject, PrimeCondition) %>%
 summarise_at(vars(zRT_del_final, RTDelayed), mean)

 z_RT_32_imm$PrimeCondition = as.factor(as.character(z_RT_32_imm$PrimeCondition))
 z_RT_32_imm$Subject = as.factor(as.character(z_RT_32_imm$Subject))
 
 z_RT_32_del$PrimeCondition = as.factor(as.character(z_RT_32_del$PrimeCondition))
 z_RT_32_del$Subject = as.factor(as.character(z_RT_32_del$Subject))
 
 ## WE have 1 missing cells in both zRTimm and zRTdel for S12
 ## So we find mean of the condition and put it there
 
 zRT_immacc_32 = group_by(memory32_imm_trim, PrimeCondition)%>%
   summarise_at(vars(zRT_imm_final, RTImmediate), mean)
 zRT_delacc_32 = group_by(memory32_del_trim, PrimeCondition)%>%
   summarise_at(vars(zRT_del_final, RTDelayed), mean)

z_RT_32_imm [115,] = c("13", "Semantic", 0.059984019, 1706.724 )

z_RT_32_del [115,] = c("13", "Semantic", -0.04081291, 1368.575)

 z_RT_32_imm$zRT_imm_final = as.numeric(as.character(z_RT_32_imm$zRT_imm_final))
 z_RT_32_imm$RTImmediate = as.numeric(as.character(z_RT_32_imm$RTImmediate))

 z_RT_32_del$zRT_del_final = as.numeric(as.character(z_RT_32_del$zRT_del_final))
 z_RT_32_del$RTDelayed = as.numeric(as.character(z_RT_32_del$RTDelayed))

 
  ## IMMEDIATE
 
 z_immediate_aov_32 = aov(data = z_RT_32_imm, 
                                      zRT_imm_final ~ PrimeCondition +
                                  Error(Subject/PrimeCondition))
 summary(z_immediate_aov_32)
 
 options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 imm_lsm = lsmeans::lsmeans(z_immediate_aov_32, c("PrimeCondition"))
 prime_effect = cld(imm_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
 kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
 
 ## DELAYED
 
 z_delayed_aov_32 = aov(data = z_RT_32_del, 
                                      zRT_del_final ~ PrimeCondition +
                                  Error(Subject/PrimeCondition))
 summary(z_delayed_aov_32)
 
 options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 imm_lsm = lsmeans::lsmeans(z_delayed_aov_32, c("PrimeCondition"))
 prime_effect = cld(imm_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))

```

### Figures for zRT

```{r}
# IMMEDIATE RECALL
 library(Rmisc)
 zRT_imm = summarySE(z_RT_32_imm, 
                       measurevar = "zRT_imm_final",
                       groupvars = c("PrimeCondition"))
 zRT_del = summarySE(z_RT_32_del, 
                       measurevar = "zRT_del_final",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 zRT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = zRT_imm_final))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRT_imm_final - ci, ymax = zRT_imm_final + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean z-RT") + 
   ggtitle("Immediate: Mean z-RT by Prime Condition")
 
 #DELAYED
 zRT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
 ggplot(aes(x = PrimeCondition, y = zRT_del_final))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRT_del_final - ci, ymax = zRT_del_final + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean zRT") + 
   ggtitle("Delayed: Mean zRT by Prime Condition")
```

### Figures for Raw RT

```{r}
# IMMEDIATE RECALL
 library(Rmisc)
 RT_imm = summarySE(z_RT_32_imm, 
                       measurevar = "RTImmediate",
                       groupvars = c("PrimeCondition"))
 RT_del = summarySE(z_RT_32_del, 
                       measurevar = "RTDelayed",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 RT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = RTImmediate))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = RTImmediate - ci, ymax = RTImmediate + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Immediate: Mean RT by Prime Condition")
 
 #DELAYED
 RT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
 ggplot(aes(x = PrimeCondition, y = RTDelayed))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = RTDelayed - ci, ymax = RTDelayed + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Delayed: Mean RT by Prime Condition")
```


### z-RT Conditional Analysis
```{r}
library(dplyr)
 zRT_cond_32 = group_by(memory32, ImmediateAccuracy, PrimeCondition) %>%
   summarise_at(vars(zRT_del), mean)

 zRT_cond_sub_32 = group_by(memory32, Subject, ImmediateAccuracy,
                                  PrimeCondition) %>%
   summarise_at(vars(zRT_del), mean)

 zRT_cond_sub_correct_32 = subset(zRT_cond_sub_32,
                                  zRT_cond_sub_32$ImmediateAccuracy == "1")

 ## see the mean RTs delayed for correct and incorrect targets:
 ## to fill missing cells
 zRT_immacc_32 = group_by(memory32, ImmediateAccuracy, PrimeCondition)%>%
   summarise_at(vars(zRT_imm, zRT_del), mean)

# Merging immediate and delayed into one file:
 ## now we have conditional delayed accuracies in cond_sub_correct
 ## and we have immediate accuracies in prime_subject_acc
 ## now we must combine the two files.

 colnames(zRT_cond_sub_correct_32) = c("Subject", "IA", "PrimeCondition", "Delayed")
 colnames(z_RT_32) = c("Subject", "PrimeCondition", "Immediate", "zRTD")

 zRT_final_combined_32 = merge(zRT_cond_sub_correct_32,
                           z_RT_32, by = c("Subject", "PrimeCondition"))
 #now we have immediate and delayed accuracy in wide format. need to convert to long format.
 #first we remove uneccesary columns
 zRT_final_combined_32 = zRT_final_combined_32[, -c(3,6)]
 library(tidyr)
 zRT_long_32 <- zRT_final_combined_32 %>%
   gather(Delay, zRT, Immediate, Delayed)


 zRT_long_32 <- zRT_long_32[order(zRT_long_32$Subject),]

 zRT_long_32$Delay = as.factor(as.character(zRT_long_32$Delay))


 zRT_long_32$zRT = as.numeric(as.character(zRT_long_32$zRT))
 zRT_long_32$Subject = as.factor(as.character(zRT_long_32$Subject))
 zRT_final_aov = aov(data = zRT_long_32, zRT ~ Delay*PrimeCondition +
                   Error(Subject/(Delay*PrimeCondition)))
 summary(zRT_final_aov)



 library(multcomp)
 library(knitr)
 options(contrasts = c('contr.sum', 'contr.poly'))

 conditional_lsm = lsmeans::lsmeans(zRT_final_aov, c("Delay", "PrimeCondition"))
 prime_effect = cld(conditional_lsm, alpha = 0.05,
                 adjust = "tukey", details = TRUE, by = "PrimeCondition")
 kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
```

### Figures
```{r}

## IMMEDIATE RECALL
 library(Rmisc)
 zRT_imm = summarySE(z_RT_32, 
                       measurevar = "Immediate",
                       groupvars = c("PrimeCondition"))
 zRT_del = summarySE(z_RT_32, 
                       measurevar = "zRTD",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 zRT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = Immediate))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = Immediate - ci, ymax = Immediate + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Immediate: Mean RT by Prime Condition")
 
 #DELAYED
 zRT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = zRTD))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRTD - ci, ymax = zRTD + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean zRT") + 
   ggtitle("Delayed: Mean zRT by Prime Condition")
 
 
 ## PLOTTING INTERACTION
 zRT_agg = group_by(zRT_long_32, Delay, PrimeCondition)%>%
   summarise_at(vars(zRT), mean)
 library(Rmisc)
 zRT_agg_rmisc = summarySE(zRT_long_32, 
                       measurevar = "zRT",
                       groupvars = c("Delay", "PrimeCondition"))
 
 zRT_agg_rmisc %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = zRT, fill = Delay))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
   geom_errorbar(aes(ymin = zRT - ci, ymax = zRT + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Mean RT by Prime Condition and Delay")
```

## 48 ms

### First Trim for Error Trials and At 250 ms and 6000 ms

```{r}
memory48_trim = memory48 %>% filter(ImmediateAccuracy == '1') 
## removes 36 % trials

## now removing  <250 and >6000 trials

memory48_imm = memory48_trim %>% filter(RTImmediate >= 250 & RTImmediate <=6000)
## removes 0.8% trials
memory48_del = memory48_trim %>% filter(RTDelayed >=250 & RTImmediate <= 6000) 
## removes 1.1% trials
```


### Making the z-scores

For immediate RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_48 = group_by(memory48_imm, Subject) %>%
   summarise_at(vars(RTImmediate), mean)
 colnames(memory_mean_48) = c("Subject", "meanRTimm")
 
 memory_sd_48 = group_by(memory48_imm, Subject) %>%
   summarise_at(vars(RTImmediate), sd)
 colnames(memory_sd_48) = c("Subject", "sdRTimm")
 
 memory_agg_48 = merge(memory_mean_48, memory_sd_48, by = "Subject")
 
 ## merge aggregate info with long data
 memory48_imm = merge(memory48_imm, memory_agg_48, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory48_imm = memory48_imm %>% mutate(zRT_imm = 
                                          (RTImmediate - meanRTimm)/sdRTimm)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory48_imm, Subject) %>%
   summarise_at(vars(zRT_imm), mean)

```


For delayed RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_48 = group_by(memory48_del, Subject) %>%
   summarise_at(vars(RTDelayed), mean)
 colnames(memory_mean_48) = c("Subject", "meanRTdel")
 
 memory_sd_48 = group_by(memory48_del, Subject) %>%
   summarise_at(vars(RTDelayed), sd)
 colnames(memory_sd_48) = c("Subject", "sdRTdel")
 
 memory_agg_48 = merge(memory_mean_48, memory_sd_48, by = "Subject")
 
 ## merge aggregate info with long data
 memory48_del = merge(memory48_del, memory_agg_48, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory48_del = memory48_del %>% mutate(zRT_del = 
                                          (RTDelayed - meanRTdel)/sdRTdel)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory48_del, Subject) %>%
   summarise_at(vars(zRT_del), mean)
```

### Trimming and repeat z-scoring

```{r}
memory48_imm_trim = memory48_imm %>% filter(zRT_imm >= -3 & zRT_imm <= 3)
## removes 1.6% trials
memory48_del_trim = memory48_del %>% filter(zRT_del >= -3 & zRT_del <= 3)
## removes 2.9 % trials 
```

For immediate RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_48 = group_by(memory48_imm_trim, Subject) %>%
   summarise_at(vars(RTImmediate), mean)
 colnames(memory_mean_48) = c("Subject", "meanRTimm_final")
 
 memory_sd_48 = group_by(memory48_imm_trim, Subject) %>%
   summarise_at(vars(RTImmediate), sd)
 colnames(memory_sd_48) = c("Subject", "sdRTimm_final")
 
 memory_agg_48 = merge(memory_mean_48, memory_sd_48, by = "Subject")
 
 ## merge aggregate info with long data
 memory48_imm_trim = merge(memory48_imm_trim, 
                           memory_agg_48, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory48_imm_trim = memory48_imm_trim %>% mutate(zRT_imm_final = 
                          (RTImmediate - meanRTimm_final)/sdRTimm_final)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory48_imm_trim, Subject) %>%
   summarise_at(vars(zRT_imm_final), mean)

```

For delayed RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_48 = group_by(memory48_del_trim, Subject) %>%
   summarise_at(vars(RTDelayed), mean)
 colnames(memory_mean_48) = c("Subject", "meanRTdel_final")
 
 memory_sd_48 = group_by(memory48_del_trim, Subject) %>%
   summarise_at(vars(RTDelayed), sd)
 colnames(memory_sd_48) = c("Subject", "sdRTdel_final")
 
 memory_agg_48 = merge(memory_mean_48, memory_sd_48, by = "Subject")
 
 ## merge aggregate info with long data
 memory48_del_trim = merge(memory48_del_trim, 
                           memory_agg_48, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory48_del_trim = memory48_del_trim %>% mutate(zRT_del_final = 
                             (RTDelayed - meanRTdel_final)/sdRTdel_final)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory48_del_trim, Subject) %>%
   summarise_at(vars(zRT_del_final), mean)
```

 
### Immediate and Delayed ANOVAs
```{r}
 z_RT_48_imm = group_by(memory48_imm_trim, Subject, PrimeCondition) %>%
 summarise_at(vars(zRT_imm_final, RTImmediate), mean)

 z_RT_48_del = group_by(memory48_del_trim, Subject, PrimeCondition) %>%
 summarise_at(vars(zRT_del_final, RTDelayed), mean)

 z_RT_48_imm$PrimeCondition = as.factor(as.character(z_RT_48_imm$PrimeCondition))
 z_RT_48_imm$Subject = as.factor(as.character(z_RT_48_imm$Subject))
 
 z_RT_48_del$PrimeCondition = as.factor(as.character(z_RT_48_del$PrimeCondition))
 z_RT_48_del$Subject = as.factor(as.character(z_RT_48_del$Subject))
 
 ## WE have 2 missing cells in both zRTimm and zRTdel for S12
 ## So we find mean of the condition and put it there
 
 zRT_immacc_48 = group_by(memory48_imm_trim, PrimeCondition)%>%
   summarise_at(vars(zRT_imm_final, RTImmediate), mean)
 zRT_delacc_48 = group_by(memory48_del_trim, PrimeCondition)%>%
   summarise_at(vars(zRT_del_final, RTDelayed), mean)

z_RT_48_imm [89,] = c("12", "Semantic", 0.17544035, 1557.688 )
z_RT_48_imm [90,] = c("12", "UnSemantic", 0.11884351, 1551.179 )
 
z_RT_48_del [89,] = c("12", "Semantic", 0.07134476, 1365.250)
z_RT_48_del [90,] = c("12", "UnSemantic", -0.01453853, 1331.578)
 
 z_RT_48_imm$zRT_imm_final = as.numeric(as.character(z_RT_48_imm$zRT_imm_final))
 z_RT_48_imm$RTImmediate = as.numeric(as.character(z_RT_48_imm$RTImmediate))

 z_RT_48_del$zRT_del_final = as.numeric(as.character(z_RT_48_del$zRT_del_final))
 z_RT_48_del$RTDelayed = as.numeric(as.character(z_RT_48_del$RTDelayed))

 
  ## IMMEDIATE
 
 z_immediate_aov_48 = aov(data = z_RT_48_imm, 
                                      RTImmediate ~ PrimeCondition +
                                  Error(Subject/PrimeCondition))
 summary(z_immediate_aov_48)
 
 options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 imm_lsm = lsmeans::lsmeans(z_immediate_aov_48, c("PrimeCondition"))
 prime_effect = cld(imm_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
 kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
 
 ## DELAYED
 
 z_delayed_aov_48 = aov(data = z_RT_48_del, 
                                      RTDelayed ~ PrimeCondition +
                                  Error(Subject/PrimeCondition))
 summary(z_delayed_aov_48)
 
 options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 imm_lsm = lsmeans::lsmeans(z_delayed_aov_48, c("PrimeCondition"))
 prime_effect = cld(imm_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))

```

### Figures for zRT

```{r}
# IMMEDIATE RECALL
 library(Rmisc)
 zRT_imm = summarySE(z_RT_48_imm, 
                       measurevar = "zRT_imm_final",
                       groupvars = c("PrimeCondition"))
 zRT_del = summarySE(z_RT_48_del, 
                       measurevar = "zRT_del_final",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 zRT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = zRT_imm_final))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRT_imm_final - ci, ymax = zRT_imm_final + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean z-RT") + 
   ggtitle("Immediate: Mean z-RT by Prime Condition")
 
 #DELAYED
 zRT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
 ggplot(aes(x = PrimeCondition, y = zRT_del_final))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRT_del_final - ci, ymax = zRT_del_final + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean zRT") + 
   ggtitle("Delayed: Mean zRT by Prime Condition")
```

### Figures for Raw RT

```{r}
# IMMEDIATE RECALL
 library(Rmisc)
 RT_imm = summarySE(z_RT_48_imm, 
                       measurevar = "RTImmediate",
                       groupvars = c("PrimeCondition"))
 RT_del = summarySE(z_RT_48_del, 
                       measurevar = "RTDelayed",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 RT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = RTImmediate))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = RTImmediate - ci, ymax = RTImmediate + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Immediate: Mean RT by Prime Condition")
 
 #DELAYED
 RT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
 ggplot(aes(x = PrimeCondition, y = RTDelayed))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = RTDelayed - ci, ymax = RTDelayed + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Delayed: Mean RT by Prime Condition")
```


### z-RT Conditional Recall Analysis
```{r}
 library(dplyr)
 zRT_cond_48 = group_by(memory48, ImmediateAccuracy, PrimeCondition) %>%
   summarise_at(vars(zRT_del), mean)
 
 zRT_cond_sub_48 = group_by(memory48, Subject, ImmediateAccuracy, 
                                  PrimeCondition) %>%
   summarise_at(vars(zRT_del), mean)
 
 zRT_cond_sub_correct_48 = subset(zRT_cond_sub_48, 
                                  zRT_cond_sub_48$ImmediateAccuracy == "1")
 
 ## see the mean RTs delayed for correct and incorrect targets: 
 ## to fill missing cells
 zRT_immacc_48 = group_by(memory48, ImmediateAccuracy, PrimeCondition)%>%
   summarise_at(vars(zRT_imm, zRT_del), mean)
 
 ## for 48 ms
 
 zRT_cond_sub_correct_48 [89,] = c("12", 1, "Semantic", -0.099613631 )
 zRT_cond_sub_correct_48 [90,] = c("12", 1, "UnSemantic", -0.115493136 )
 

 
# Merging immediate and delayed into one file:
 ## now we have conditional delayed accuracies in cond_sub_correct
 ## and we have immediate accuracies in prime_subject_acc
 ## now we must combine the two files. 
 
 colnames(zRT_cond_sub_correct_48) = c("Subject", "IA", "PrimeCondition", "Delayed")
 colnames(z_RT_48) = c("Subject", "PrimeCondition", "Immediate", "zRTD")
 
 zRT_final_combined_48 = merge(zRT_cond_sub_correct_48, 
                           z_RT_48, by = c("Subject", "PrimeCondition"))
 #now we have immediate and delayed accuracy in wide format. need to convert to long format.
 #first we remove uneccesary columns
 zRT_final_combined_48 = zRT_final_combined_48[, -c(3,6)]
library(tidyr)
 zRT_long_48 <- zRT_final_combined_48 %>%
   gather(Delay, zRT, Immediate, Delayed)
   
 
 zRT_long_48 <- zRT_long_48[order(zRT_long_48$Subject),]
 
 zRT_long_48$Delay = as.factor(as.character(zRT_long_48$Delay))
 
 
 zRT_long_48$zRT = as.numeric(as.character(zRT_long_48$zRT))
 
 zRT_final_aov = aov(data = zRT_long_48, zRT ~ Delay*PrimeCondition + 
                   Error(Subject/(Delay*PrimeCondition)))
 summary(zRT_final_aov)
 
 
 
 library(multcomp)
 library(knitr)
 options(contrasts = c('contr.sum', 'contr.poly'))
 
conditional_lsm = lsmeans::lsmeans(zRT_final_aov, c("Delay", "PrimeCondition"))
 prime_effect = cld(conditional_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE, by = "Delay")
 kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
 
```
### Figures
```{r}


 ## PLOTTING INTERACTION
 zRT_agg = group_by(zRT_long_48, Delay, PrimeCondition)%>%
   summarise_at(vars(zRT), mean)
 library(Rmisc)
 zRT_agg_rmisc = summarySE(zRT_long_48, 
                       measurevar = "zRT",
                       groupvars = c("Delay", "PrimeCondition"))
 zRT_agg_rmisc %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
 ggplot(aes(x = PrimeCondition, y = zRT, fill = Delay))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
   geom_errorbar(aes(ymin = zRT - ci, ymax = zRT + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Mean RT by Prime Condition and Delay")
```

## 125 ms

### First Trim for Error Trials and At 250 ms and 6000 ms

```{r}

## filtering out Subject 8 and Subject 88 first
memory125 = memory125 %>% filter(!Subject %in% c("8", "88"))
memory125_trim = memory125 %>% filter(ImmediateAccuracy == '1') 
## removes 36 % trials

## now removing  <250 and >6000 trials

memory125_imm = memory125_trim %>% filter(RTImmediate >= 250 & RTImmediate <=6000)
## removes 0.8% trials
memory125_del = memory125_trim %>% filter(RTDelayed >=250 & RTImmediate <= 6000) 
## removes 1.1% trials
```


### Making the z-scores

For immediate RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_125 = group_by(memory125_imm, Subject) %>%
   summarise_at(vars(RTImmediate), mean)
 colnames(memory_mean_125) = c("Subject", "meanRTimm")
 
 memory_sd_125 = group_by(memory125_imm, Subject) %>%
   summarise_at(vars(RTImmediate), sd)
 colnames(memory_sd_125) = c("Subject", "sdRTimm")
 
 memory_agg_125 = merge(memory_mean_125, memory_sd_125, by = "Subject")
 
 ## merge aggregate info with long data
 memory125_imm = merge(memory125_imm, memory_agg_125, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory125_imm = memory125_imm %>% mutate(zRT_imm = 
                                          (RTImmediate - meanRTimm)/sdRTimm)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory125_imm, Subject) %>%
   summarise_at(vars(zRT_imm), mean)

```


For delayed RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_125 = group_by(memory125_del, Subject) %>%
   summarise_at(vars(RTDelayed), mean)
 colnames(memory_mean_125) = c("Subject", "meanRTdel")
 
 memory_sd_125 = group_by(memory125_del, Subject) %>%
   summarise_at(vars(RTDelayed), sd)
 colnames(memory_sd_125) = c("Subject", "sdRTdel")
 
 memory_agg_125 = merge(memory_mean_125, memory_sd_125, by = "Subject")
 
 ## merge aggregate info with long data
 memory125_del = merge(memory125_del, memory_agg_125, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory125_del = memory125_del %>% mutate(zRT_del = 
                                          (RTDelayed - meanRTdel)/sdRTdel)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory125_del, Subject) %>%
   summarise_at(vars(zRT_del), mean)
```

### Trimming and repeat z-scoring

```{r}
memory125_imm_trim = memory125_imm %>% filter(zRT_imm >= -3 & zRT_imm <= 3)
## removes 1.6% trials
memory125_del_trim = memory125_del %>% filter(zRT_del >= -3 & zRT_del <= 3)
## removes 2.9 % trials 
```

For immediate RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_125 = group_by(memory125_imm_trim, Subject) %>%
   summarise_at(vars(RTImmediate), mean)
 colnames(memory_mean_125) = c("Subject", "meanRTimm_final")
 
 memory_sd_125 = group_by(memory125_imm_trim, Subject) %>%
   summarise_at(vars(RTImmediate), sd)
 colnames(memory_sd_125) = c("Subject", "sdRTimm_final")
 
 memory_agg_125 = merge(memory_mean_125, memory_sd_125, by = "Subject")
 
 ## merge aggregate info with long data
 memory125_imm_trim = merge(memory125_imm_trim, 
                           memory_agg_125, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory125_imm_trim = memory125_imm_trim %>% mutate(zRT_imm_final = 
                          (RTImmediate - meanRTimm_final)/sdRTimm_final)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory125_imm_trim, Subject) %>%
   summarise_at(vars(zRT_imm_final), mean)

```

For delayed RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_125 = group_by(memory125_del_trim, Subject) %>%
   summarise_at(vars(RTDelayed), mean)
 colnames(memory_mean_125) = c("Subject", "meanRTdel_final")
 
 memory_sd_125 = group_by(memory125_del_trim, Subject) %>%
   summarise_at(vars(RTDelayed), sd)
 colnames(memory_sd_125) = c("Subject", "sdRTdel_final")
 
 memory_agg_125 = merge(memory_mean_125, memory_sd_125, by = "Subject")
 
 ## merge aggregate info with long data
 memory125_del_trim = merge(memory125_del_trim, 
                           memory_agg_125, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory125_del_trim = memory125_del_trim %>% mutate(zRT_del_final = 
                             (RTDelayed - meanRTdel_final)/sdRTdel_final)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory125_del_trim, Subject) %>%
   summarise_at(vars(zRT_del_final), mean)
```

 
### Immediate and Delayed ANOVAs
```{r}
 z_RT_125_imm = group_by(memory125_imm_trim, Subject, PrimeCondition) %>%
 summarise_at(vars(zRT_imm_final, RTImmediate), mean)

 z_RT_125_del = group_by(memory125_del_trim, Subject, PrimeCondition) %>%
 summarise_at(vars(zRT_del_final, RTDelayed), mean)

 z_RT_125_imm$PrimeCondition = as.factor(as.character(z_RT_125_imm$PrimeCondition))
 z_RT_125_imm$Subject = as.factor(as.character(z_RT_125_imm$Subject))
 
 z_RT_125_del$PrimeCondition = as.factor(as.character(z_RT_125_del$PrimeCondition))
 z_RT_125_del$Subject = as.factor(as.character(z_RT_125_del$Subject))
 
 ## WE have 3 missing cells in both zRTimm and zRTdel for S12
 ## So we find mean of the condition and put it there
 
 zRT_immacc_125 = group_by(memory125_imm_trim, PrimeCondition)%>%
   summarise_at(vars(zRT_imm_final, RTImmediate), mean)
 zRT_delacc_125 = group_by(memory125_del_trim, PrimeCondition)%>%
   summarise_at(vars(zRT_del_final, RTDelayed), mean)

z_RT_125_imm [128,] = c("21", "Semantic", -0.09959580, 1471.750 )
z_RT_125_imm [129,] = c("21", "UnSemantic", 0.18262175, 1691.836 )
z_RT_125_imm [130,] = c("21", "Neutral", 0.07700379, 1550.566 )
 
z_RT_125_del [128,] = c("21", "Semantic", -0.006282993, 1544.463 )
z_RT_125_del [129,] = c("21", "UnSemantic", 0.065456727, 1422.580 )
z_RT_125_del [130,] = c("21", "Neutral", -0.102611092, 1379.160 )
  
 z_RT_125_imm$zRT_imm_final = as.numeric(as.character(z_RT_125_imm$zRT_imm_final))
 z_RT_125_imm$RTImmediate = as.numeric(as.character(z_RT_125_imm$RTImmediate))

 z_RT_125_del$zRT_del_final = as.numeric(as.character(z_RT_125_del$zRT_del_final))
 z_RT_125_del$RTDelayed = as.numeric(as.character(z_RT_125_del$RTDelayed))

 
  ## IMMEDIATE
 
 z_immediate_aov_125 = aov(data = z_RT_125_imm, 
                                      zRT_imm_final ~ PrimeCondition +
                                  Error(Subject/PrimeCondition))
 summary(z_immediate_aov_125)
 
 options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 imm_lsm = lsmeans::lsmeans(z_immediate_aov_125, c("PrimeCondition"))
 prime_effect = cld(imm_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
 kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
 
 ## DELAYED
 
 z_delayed_aov_125 = aov(data = z_RT_125_del, 
                                      zRT_del_final ~ PrimeCondition +
                                  Error(Subject/PrimeCondition))
 summary(z_delayed_aov_125)
 
 options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 imm_lsm = lsmeans::lsmeans(z_delayed_aov_125, c("PrimeCondition"))
 prime_effect = cld(imm_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))

```

### Figures for zRT

```{r}
# IMMEDIATE RECALL
 library(Rmisc)
 zRT_imm = summarySE(z_RT_125_imm, 
                       measurevar = "zRT_imm_final",
                       groupvars = c("PrimeCondition"))
 zRT_del = summarySE(z_RT_125_del, 
                       measurevar = "zRT_del_final",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 zRT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = zRT_imm_final))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRT_imm_final - ci, ymax = zRT_imm_final + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean z-RT") + 
   ggtitle("Immediate: Mean z-RT by Prime Condition")
 
 #DELAYED
 zRT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
 ggplot(aes(x = PrimeCondition, y = zRT_del_final))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRT_del_final - ci, ymax = zRT_del_final + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean zRT") + 
   ggtitle("Delayed: Mean zRT by Prime Condition")
```

### Figures for Raw RT

```{r}
# IMMEDIATE RECALL
 library(Rmisc)
 RT_imm = summarySE(z_RT_125_imm, 
                       measurevar = "RTImmediate",
                       groupvars = c("PrimeCondition"))
 RT_del = summarySE(z_RT_125_del, 
                       measurevar = "RTDelayed",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 RT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = RTImmediate))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = RTImmediate - ci, ymax = RTImmediate + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Immediate: Mean RT by Prime Condition")
 
 #DELAYED
 RT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
 ggplot(aes(x = PrimeCondition, y = RTDelayed))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = RTDelayed - ci, ymax = RTDelayed + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Delayed: Mean RT by Prime Condition")
```

## 500 ms

### First Trim for Error Trials and At 250 ms and 6000 ms

```{r}
memory500_trim = memory500 %>% filter(ImmediateAccuracy == '1') 
## removes 40 % trials

## now removing  <250 and >6000 trials

memory500_imm = memory500_trim %>% filter(RTImmediate >= 250 & RTImmediate <=6000)
## removes 0.8% trials
memory500_del = memory500_trim %>% filter(RTDelayed >=250 & RTImmediate <= 6000) 
## removes 1.2% trials
```


### Making the z-scores

For immediate RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_500 = group_by(memory500_imm, Subject) %>%
   summarise_at(vars(RTImmediate), mean)
 colnames(memory_mean_500) = c("Subject", "meanRTimm")
 
 memory_sd_500 = group_by(memory500_imm, Subject) %>%
   summarise_at(vars(RTImmediate), sd)
 colnames(memory_sd_500) = c("Subject", "sdRTimm")
 
 memory_agg_500 = merge(memory_mean_500, memory_sd_500, by = "Subject")
 
 ## merge aggregate info with long data
 memory500_imm = merge(memory500_imm, memory_agg_500, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory500_imm = memory500_imm %>% mutate(zRT_imm = 
                                          (RTImmediate - meanRTimm)/sdRTimm)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory500_imm, Subject) %>%
   summarise_at(vars(zRT_imm), mean)

```


For delayed RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_500 = group_by(memory500_del, Subject) %>%
   summarise_at(vars(RTDelayed), mean)
 colnames(memory_mean_500) = c("Subject", "meanRTdel")
 
 memory_sd_500 = group_by(memory500_del, Subject) %>%
   summarise_at(vars(RTDelayed), sd)
 colnames(memory_sd_500) = c("Subject", "sdRTdel")
 
 memory_agg_500 = merge(memory_mean_500, memory_sd_500, by = "Subject")
 
 ## merge aggregate info with long data
 memory500_del = merge(memory500_del, memory_agg_500, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory500_del = memory500_del %>% mutate(zRT_del = 
                                          (RTDelayed - meanRTdel)/sdRTdel)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory500_del, Subject) %>%
   summarise_at(vars(zRT_del), mean)
```

### Trimming and repeat z-scoring

```{r}
memory500_imm_trim = memory500_imm %>% filter(zRT_imm >= -3 & zRT_imm <= 3)
## removes 1.6% trials
memory500_del_trim = memory500_del %>% filter(zRT_del >= -3 & zRT_del <= 3)
## removes 2.9 % trials 
```

For immediate RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_500 = group_by(memory500_imm_trim, Subject) %>%
   summarise_at(vars(RTImmediate), mean)
 colnames(memory_mean_500) = c("Subject", "meanRTimm_final")
 
 memory_sd_500 = group_by(memory500_imm_trim, Subject) %>%
   summarise_at(vars(RTImmediate), sd)
 colnames(memory_sd_500) = c("Subject", "sdRTimm_final")
 
 memory_agg_500 = merge(memory_mean_500, memory_sd_500, by = "Subject")
 
 ## merge aggregate info with long data
 memory500_imm_trim = merge(memory500_imm_trim, 
                           memory_agg_500, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory500_imm_trim = memory500_imm_trim %>% mutate(zRT_imm_final = 
                          (RTImmediate - meanRTimm_final)/sdRTimm_final)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory500_imm_trim, Subject) %>%
   summarise_at(vars(zRT_imm_final), mean)

```

For delayed RTs
```{r}
 library(dplyr)
 ## aggregate per subject all IVs and DVs
 memory_mean_500 = group_by(memory500_del_trim, Subject) %>%
   summarise_at(vars(RTDelayed), mean)
 colnames(memory_mean_500) = c("Subject", "meanRTdel_final")
 
 memory_sd_500 = group_by(memory500_del_trim, Subject) %>%
   summarise_at(vars(RTDelayed), sd)
 colnames(memory_sd_500) = c("Subject", "sdRTdel_final")
 
 memory_agg_500 = merge(memory_mean_500, memory_sd_500, by = "Subject")
 
 ## merge aggregate info with long data
 memory500_del_trim = merge(memory500_del_trim, 
                           memory_agg_500, by = "Subject", all.x = T)
 
 ## person and grand-mean centered scores using original and aggregate
 library(dplyr)
 memory500_del_trim = memory500_del_trim %>% mutate(zRT_del_final = 
                             (RTDelayed - meanRTdel_final)/sdRTdel_final)
 
 ## checking: subject level means should be zero
 
 sub_mem = group_by(memory500_del_trim, Subject) %>%
   summarise_at(vars(zRT_del_final), mean)
```

 
### Immediate and Delayed ANOVAs
```{r}
 z_RT_500_imm = group_by(memory500_imm_trim, Subject, PrimeCondition) %>%
 summarise_at(vars(zRT_imm_final, RTImmediate), mean)

 z_RT_500_del = group_by(memory500_del_trim, Subject, PrimeCondition) %>%
 summarise_at(vars(zRT_del_final, RTDelayed), mean)

 z_RT_500_imm$PrimeCondition = as.factor(as.character(z_RT_500_imm$PrimeCondition))
 z_RT_500_imm$Subject = as.factor(as.character(z_RT_500_imm$Subject))
 
 z_RT_500_del$PrimeCondition = as.factor(as.character(z_RT_500_del$PrimeCondition))
 z_RT_500_del$Subject = as.factor(as.character(z_RT_500_del$Subject))
 
 ## WE have 2 missing cells in both zRTimm and zRTdel for S12
 ## So we find mean of the condition and put it there
 
 zRT_immacc_500 = group_by(memory500_imm_trim, PrimeCondition)%>%
   summarise_at(vars(zRT_imm_final, RTImmediate), mean)
 zRT_delacc_500 = group_by(memory500_del_trim, PrimeCondition)%>%
   summarise_at(vars(zRT_del_final, RTDelayed), mean)

z_RT_500_imm  [99,] = c("36", "Neutral",0.06884688, 1497.188 )
z_RT_500_imm [100,] = c("42","Phonological", -0.07480176,1406.984 )
 
z_RT_500_del [99,] = c("36","Neutral",0.05098498, 1424.079 )
z_RT_500_del [100,] = c("42","Phonological", -0.06388878,1341.323  )
 
 z_RT_500_imm$zRT_imm_final = as.numeric(as.character(z_RT_500_imm$zRT_imm_final))
 z_RT_500_imm$RTImmediate = as.numeric(as.character(z_RT_500_imm$RTImmediate))

 z_RT_500_del$zRT_del_final = as.numeric(as.character(z_RT_500_del$zRT_del_final))
 z_RT_500_del$RTDelayed = as.numeric(as.character(z_RT_500_del$RTDelayed))

 
  ## IMMEDIATE
 
 z_immediate_aov_500 = aov(data = z_RT_500_imm, 
                                      zRT_imm_final ~ PrimeCondition +
                                  Error(Subject/PrimeCondition))
 summary(z_immediate_aov_500)
 
 options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 imm_lsm = lsmeans::lsmeans(z_immediate_aov_500, c("PrimeCondition"))
 prime_effect = cld(imm_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
 kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
 
 ## DELAYED
 
 z_delayed_aov_500 = aov(data = z_RT_500_del, 
                                      zRT_del_final ~ PrimeCondition +
                                  Error(Subject/PrimeCondition))
 summary(z_delayed_aov_500)
 
 options(contrasts = c('contr.sum', 'contr.poly'))
 library(lsmeans)
 library(multcomp)
 imm_lsm = lsmeans::lsmeans(z_delayed_aov_500, c("PrimeCondition"))
 prime_effect = cld(imm_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE)
 library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))

```

### Figures for zRT

```{r}
# IMMEDIATE RECALL
 library(Rmisc)
 zRT_imm = summarySE(z_RT_500_imm, 
                       measurevar = "zRT_imm_final",
                       groupvars = c("PrimeCondition"))
 zRT_del = summarySE(z_RT_500_del, 
                       measurevar = "zRT_del_final",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 zRT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = zRT_imm_final))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRT_imm_final - ci, ymax = zRT_imm_final + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean z-RT") + 
   ggtitle("Immediate: Mean z-RT by Prime Condition")
 
 #DELAYED
 zRT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
 ggplot(aes(x = PrimeCondition, y = zRT_del_final))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRT_del_final - ci, ymax = zRT_del_final + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean zRT") + 
   ggtitle("Delayed: Mean zRT by Prime Condition")
```

### Figures for Raw RT

```{r}
# IMMEDIATE RECALL
 library(Rmisc)
 RT_imm = summarySE(z_RT_500_imm, 
                       measurevar = "RTImmediate",
                       groupvars = c("PrimeCondition"))
 RT_del = summarySE(z_RT_500_del, 
                       measurevar = "RTDelayed",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 RT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = RTImmediate))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, 
            fill = "darkgreen")+
   geom_errorbar(aes(ymin = RTImmediate - ci, ymax = RTImmediate + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Immediate: Mean RT by Prime Condition")
 
 #DELAYED
 RT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
 ggplot(aes(x = PrimeCondition, y = RTDelayed))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = RTDelayed - ci, ymax = RTDelayed + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Delayed: Mean RT by Prime Condition")
```

### z-RT Conditional Analysis

```{r}
 zRT_cond_500 = group_by(memory500, ImmediateAccuracy, PrimeCondition) %>%
   summarise_at(vars(zRT_del), mean)
 
 zRT_cond_sub_500 = group_by(memory500, Subject, ImmediateAccuracy, 
                                PrimeCondition) %>%
   summarise_at(vars(zRT_del), mean)
 
 
 zRT_cond_sub_correct_500 = subset(zRT_cond_sub_500, 
                                  zRT_cond_sub_500$ImmediateAccuracy == "1")
 
 ## see the mean RTs delayed for correct and incorrect targets: 
 ## to fill missing cells
 zRT_immacc_500 = group_by(memory500, ImmediateAccuracy, PrimeCondition)%>%
   summarise_at(vars(zRT_imm, zRT_del), mean)
 
#for 500 ms
#S36 and S42 have one row each missing
 zRT_cond_sub_correct_500[99,] = c("36",1,"Neutral",-0.135651850 )
 zRT_cond_sub_correct_500[100,] = c("42",1,"Phonological", -0.142223900 )
 
# Merging immediate and delayed into one file:
 ## now we have conditional delayed accuracies in cond_sub_correct
 ## and we have immediate accuracies in prime_subject_acc
 ## now we must combine the two files. 
 colnames(zRT_cond_sub_correct_500) = c("Subject", "IA", "PrimeCondition", 
                                        "Delayed")
 colnames(z_RT_500) = c("Subject", "PrimeCondition", "Immediate", "zRTD")
 
 zRT_final_combined_500 = merge(zRT_cond_sub_correct_500, 
                           z_RT_500, by = c("Subject", "PrimeCondition"))
 #now we have immediate and delayed accuracy in wide format. need to convert to long format.
 #first we remove uneccesary columns
zRT_final_combined_500 = zRT_final_combined_500[, -c(3,6)]
 library(tidyr)
 zRT_long_500 <- zRT_final_combined_500 %>%
   gather(Delay, zRT, Immediate, Delayed)
   
 
 zRT_long_500 <- zRT_long_500[order(zRT_long_500$Subject),]
 
 zRT_long_500$Delay = as.factor(as.character(zRT_long_500$Delay))
 
 
 zRT_long_500$zRT = as.numeric(as.character(zRT_long_500$zRT))
 
 zRT_final_aov = aov(data = zRT_long_500, zRT ~ Delay*PrimeCondition + 
                   Error(Subject/(Delay*PrimeCondition)))
 summary(zRT_final_aov)
 
 
 
 library(multcomp)
 library(knitr)
 options(contrasts = c('contr.sum', 'contr.poly'))
 
 conditional_lsm = lsmeans::lsmeans(zRT_final_aov, c("Delay", "PrimeCondition"))
 prime_effect = cld(conditional_lsm, alpha = 0.05, 
                 adjust = "tukey", details = TRUE, by = "Delay")
 kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.05 ))
 
```

### Figures
 
```{r}
 ## IMMEDIATE RECALL
 library(Rmisc)
 zRT_imm = summarySE(z_RT_500, 
                       measurevar = "Immediate",
                       groupvars = c("PrimeCondition"))
 zRT_del = summarySE(z_RT_500, 
                       measurevar = "zRTD",
                       groupvars = c("PrimeCondition"))
 ## IMMEDIATE
 library(ggplot2)
 library(ggthemes)
 zRT_imm %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = Immediate))+
   geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = Immediate - ci, ymax = Immediate + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Immediate: Mean RT by Prime Condition")
 
#DELAYED
 zRT_del %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot(aes(x = PrimeCondition, y = zRTD))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5, fill = "darkgreen")+
   geom_errorbar(aes(ymin = zRTD - ci, ymax = zRTD + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean zRT") + 
   ggtitle("Delayed: Mean zRT by Prime Condition")
 
 
 ## PLOTTING INTERACTION
 zRT_agg = group_by(zRT_long_500, Delay, PrimeCondition)%>%
   summarise_at(vars(zRT), mean)
 library(Rmisc)
 zRT_agg_rmisc = summarySE(zRT_long_500, 
                       measurevar = "zRT",
                       groupvars = c("Delay", "PrimeCondition"))
 
 zRT_agg_rmisc %>% mutate(PrimeCondition = factor(PrimeCondition, 
                                                  levels = unique(PrimeCondition),
                     labels = c("Identical", "Neutral", 
                                "Phonological", "Semantic", "Unrelated")))%>%
   ggplot( aes(x = PrimeCondition, y = zRT, fill = Delay))+
  geom_bar(stat = "identity", position = "dodge", width = 0.5)+
   geom_errorbar(aes(ymin = zRT - ci, ymax = zRT + ci),
                 width=.05, position=position_dodge(.5)) +
   theme_few()+
   xlab("Prime Condition") + ylab("Mean RT") + 
   ggtitle("Mean RT by Prime Condition and Delay")
```
 






